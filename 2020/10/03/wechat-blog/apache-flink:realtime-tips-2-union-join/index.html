<!DOCTYPE html>
<html>
<head><meta name="generator" content="Hexo 3.9.0">
    
<!-- Google Analytics -->
<script>
window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)};ga.l=+new Date;
ga('create', 'UA-150061865-1', 'auto');
ga('send', 'pageview');
</script>
<script async src="https://www.google-analytics.com/analytics.js"></script>
<!-- End Google Analytics -->


    

    
<!-- Baidu Tongji -->
<script>var _hmt = _hmt || []</script>
<script async src="//hm.baidu.com/hm.js?c013b4f82e10e4f302d6f461f20bdf63"></script>
<!-- End Baidu Tongji -->




    <meta charset="utf-8">
    
    
    
    
    <title>Tips | Flink ä½¿ç”¨ union ä»£æ›¿ joinã€cogroup | yangyichao-mango&#39;s blog</title>
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
    
    <meta name="theme-color" content="#3F51B5">
    
    
    <meta name="keywords" content="Apache Flink">
    <meta name="description" content="æœ¬ç«™&amp;ä½œè€…">
<meta name="keywords" content="Apache Flink">
<meta property="og:type" content="article">
<meta property="og:title" content="Tips | Flink ä½¿ç”¨ union ä»£æ›¿ joinã€cogroup">
<meta property="og:url" content="https://yangyichao-mango.github.io/2020/10/03/wechat-blog/apache-flink:realtime-tips-2-union-join/index.html">
<meta property="og:site_name" content="yangyichao-mango&#39;s blog">
<meta property="og:description" content="æœ¬ç«™&amp;ä½œè€…">
<meta property="og:locale" content="zh-CN">
<meta property="og:image" content="https://yangyichao-mango.github.io/blog-img/gzh/wechat.png">
<meta property="og:updated_time" content="2020-10-04T13:21:52.892Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Tips | Flink ä½¿ç”¨ union ä»£æ›¿ joinã€cogroup">
<meta name="twitter:description" content="æœ¬ç«™&amp;ä½œè€…">
<meta name="twitter:image" content="https://yangyichao-mango.github.io/blog-img/gzh/wechat.png">
    
        <link rel="alternate" type="application/atom+xml" title="yangyichao-mango&#39;s blog" href="/atom.xml">
    
    <link rel="shortcut icon" href="/img/avatar.jpg">
    <link rel="stylesheet" href="/css/style.css?v=1.7.2">
    <script>window.lazyScripts=[]</script>

    <!-- custom head -->
    

</head>

<body>
    <div id="loading" class="active"></div>

    <aside id="menu"  >
  <div class="inner flex-row-vertical">
    <a href="javascript:;" class="header-icon waves-effect waves-circle waves-light" id="menu-off">
        <i class="icon icon-lg icon-close"></i>
    </a>
    <div class="brand-wrap" style="background-image:url(/img/brand-new.jpg)">
      <div class="brand">
        <a href="/" class="avatar waves-effect waves-circle waves-light">
          <img src="/img/avatar.jpg">
        </a>
        <hgroup class="introduce">
          <h5 class="nickname">yangyichao-mango</h5>
          <a href="mailto:1048262223@qq.com" title="1048262223@qq.com" class="mail">1048262223@qq.com</a>
        </hgroup>
      </div>
    </div>
    <div class="scroll-wrap flex-col">
      <ul class="nav">
        
            <li class="waves-block waves-effect">
              <a href="/"  >
                <i class="icon icon-lg icon-home"></i>
                ä¸»é¡µ
              </a>
            </li>
        
            <li class="waves-block waves-effect">
              <a href="/archives"  >
                <i class="icon icon-lg icon-archives"></i>
                Archives
              </a>
            </li>
        
            <li class="waves-block waves-effect">
              <a href="/tags"  >
                <i class="icon icon-lg icon-tags"></i>
                Tags
              </a>
            </li>
        
            <li class="waves-block waves-effect">
              <a href="/categories"  >
                <i class="icon icon-lg icon-th-list"></i>
                Categories
              </a>
            </li>
        
            <li class="waves-block waves-effect">
              <a href="https://github.com/yangyichao-mango" target="_blank" >
                <i class="icon icon-lg icon-github"></i>
                Github
              </a>
            </li>
        
            <li class="waves-block waves-effect">
              <a href="/about"  >
                <i class="icon icon-lg icon-user"></i>
                About
              </a>
            </li>
        
            <li class="waves-block waves-effect">
              <a href="/links"  >
                <i class="icon icon-lg icon-star"></i>
                Links
              </a>
            </li>
        
      </ul>
    </div>
  </div>
</aside>

    <main id="main">
        <header class="top-header" id="header">
    <div class="flex-row">
        <a href="javascript:;" class="header-icon waves-effect waves-circle waves-light on" id="menu-toggle">
          <i class="icon icon-lg icon-navicon"></i>
        </a>
        <div class="flex-col header-title ellipsis">Tips | Flink ä½¿ç”¨ union ä»£æ›¿ joinã€cogroup</div>
        
        <div class="search-wrap" id="search-wrap">
            <a href="javascript:;" class="header-icon waves-effect waves-circle waves-light" id="back">
                <i class="icon icon-lg icon-chevron-left"></i>
            </a>
            <input type="text" id="key" class="search-input" autocomplete="off" placeholder="è¾“å…¥æ„Ÿå…´è¶£çš„å…³é”®å­—">
            <a href="javascript:;" class="header-icon waves-effect waves-circle waves-light" id="search">
                <i class="icon icon-lg icon-search"></i>
            </a>
        </div>
        
        
        <a href="javascript:;" class="header-icon waves-effect waves-circle waves-light" id="menuShare">
            <i class="icon icon-lg icon-share-alt"></i>
        </a>
        
    </div>
</header>
<header class="content-header post-header">

    <div class="container fade-scale">
        <h1 class="title">Tips | Flink ä½¿ç”¨ union ä»£æ›¿ joinã€cogroup</h1>
        <h5 class="subtitle">
            
                <time datetime="2020-10-03T06:21:53.000Z" itemprop="datePublished" class="page-time">
  2020-10-03
</time>


	<ul class="article-category-list"><li class="article-category-list-item"><a class="article-category-list-link" href="/categories/Apache-Flink/">Apache Flink</a></li></ul>

            
        </h5>
    </div>

    


</header>


<div class="container body-wrap">
    
    <aside class="post-widget">
        <nav class="post-toc-wrap post-toc-shrink" id="post-toc">
            <h4>TOC</h4>
            <ol class="post-toc"><li class="post-toc-item post-toc-level-1"><a class="post-toc-link" href="#Tips-Flink-ä½¿ç”¨-union-ä»£æ›¿-joinã€cogroup"><span class="post-toc-number">1.</span> <span class="post-toc-text">Tips | Flink ä½¿ç”¨ union ä»£æ›¿ joinã€cogroup</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#éœ€æ±‚åœºæ™¯åˆ†æ"><span class="post-toc-number">1.1.</span> <span class="post-toc-text">éœ€æ±‚åœºæ™¯åˆ†æ</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#éœ€æ±‚åœºæ™¯"><span class="post-toc-number">1.1.1.</span> <span class="post-toc-text">éœ€æ±‚åœºæ™¯</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#source-è¾“å…¥ä»¥åŠç‰¹ç‚¹"><span class="post-toc-number">1.1.2.</span> <span class="post-toc-text">source è¾“å…¥ä»¥åŠç‰¹ç‚¹</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#sink-è¾“å‡ºä»¥åŠç‰¹ç‚¹"><span class="post-toc-number">1.1.3.</span> <span class="post-toc-text">sink è¾“å‡ºä»¥åŠç‰¹ç‚¹</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#sourceã€sink-æ ·ä¾‹æ•°æ®"><span class="post-toc-number">1.1.4.</span> <span class="post-toc-text">sourceã€sink æ ·ä¾‹æ•°æ®</span></a></li></ol></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#å®ç°æ–¹æ¡ˆ"><span class="post-toc-number">1.2.</span> <span class="post-toc-text">å®ç°æ–¹æ¡ˆ</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#cogroup"><span class="post-toc-number">1.2.1.</span> <span class="post-toc-text">cogroup</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#ä¸Šè¿°å®ç°å¯èƒ½ä¼šå­˜åœ¨çš„é—®é¢˜ç‚¹"><span class="post-toc-number">1.2.2.</span> <span class="post-toc-text">ä¸Šè¿°å®ç°å¯èƒ½ä¼šå­˜åœ¨çš„é—®é¢˜ç‚¹</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#é€†æ¨é“¾è·¯"><span class="post-toc-number">1.2.3.</span> <span class="post-toc-text">é€†æ¨é“¾è·¯</span></a></li></ol></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#union"><span class="post-toc-number">1.3.</span> <span class="post-toc-text">union</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#æ€»ç»“"><span class="post-toc-number">1.4.</span> <span class="post-toc-text">æ€»ç»“</span></a></li></ol></li></ol>
        </nav>
    </aside>


<article id="post-wechat-blog/apache-flink:realtime-tips-2-union-join"
  class="post-article article-type-post fade" itemprop="blogPost">

    <div class="post-card">
        <h1 class="post-card-title">Tips | Flink ä½¿ç”¨ union ä»£æ›¿ joinã€cogroup</h1>
        <div class="post-meta">
            <time class="post-time" title="2020-10-03 14:21:53" datetime="2020-10-03T06:21:53.000Z"  itemprop="datePublished">2020-10-03</time>

            
	<ul class="article-category-list"><li class="article-category-list-item"><a class="article-category-list-link" href="/categories/Apache-Flink/">Apache Flink</a></li></ul>



            
<span id="busuanzi_container_page_pv" title="æ–‡ç« æ€»é˜…è¯»é‡" style='display:none'>
    <i class="icon icon-eye icon-pr"></i><span id="busuanzi_value_page_pv"></span>
</span>


        </div>
        <div class="post-content" id="post-content" itemprop="postContent">
            <h1 id="Tips-Flink-ä½¿ç”¨-union-ä»£æ›¿-joinã€cogroup"><a href="#Tips-Flink-ä½¿ç”¨-union-ä»£æ›¿-joinã€cogroup" class="headerlink" title="Tips | Flink ä½¿ç”¨ union ä»£æ›¿ joinã€cogroup"></a>Tips | Flink ä½¿ç”¨ union ä»£æ›¿ joinã€cogroup</h1><blockquote>
<p>æœ¬ç³»åˆ—æ¯ç¯‡æ–‡ç« éƒ½æ¯”è¾ƒçŸ­å°ï¼Œä¸å®šæœŸæ›´æ–°ï¼Œä»ä¸€äº›å®é™…çš„ case å‡ºå‘æŠ›ç –å¼•ç‰ï¼Œæé«˜å°ä¼™ä¼´çš„å§¿â™‚åŠ¿æ°´å¹³ã€‚æœ¬æ–‡ä»‹ç»åœ¨æ»¡è¶³åŸæœ‰éœ€æ±‚ã€å®ç°åŸæœ‰é€»è¾‘çš„åœºæ™¯ä¸‹ï¼Œåœ¨ Flink ä¸­ä½¿ç”¨ union ä»£æ›¿ cogroup(æˆ–è€…join) ï¼Œç®€åŒ–ä»»åŠ¡é€»è¾‘ï¼Œæå‡ä»»åŠ¡æ€§èƒ½çš„æ–¹æ³•ï¼Œé˜…è¯»æ—¶é•¿å¤§æ¦‚ä¸€åˆ†é’Ÿï¼Œè¯ä¸å¤šè¯´ï¼Œç›´æ¥è¿›å…¥æ­£æ–‡ï¼</p>
</blockquote>
<h2 id="éœ€æ±‚åœºæ™¯åˆ†æ"><a href="#éœ€æ±‚åœºæ™¯åˆ†æ" class="headerlink" title="éœ€æ±‚åœºæ™¯åˆ†æ"></a>éœ€æ±‚åœºæ™¯åˆ†æ</h2><h3 id="éœ€æ±‚åœºæ™¯"><a href="#éœ€æ±‚åœºæ™¯" class="headerlink" title="éœ€æ±‚åœºæ™¯"></a>éœ€æ±‚åœºæ™¯</h3><p>éœ€æ±‚è¯±è¯±è¯±æ¥äº†ã€‚ã€‚ã€‚æ•°æ®äº§å“å¦¹å¦¹æƒ³è¦ç»Ÿè®¡å•ä¸ªçŸ­è§†é¢‘ç²’åº¦çš„<strong>ç‚¹èµï¼Œæ’­æ”¾ï¼Œè¯„è®ºï¼Œåˆ†äº«ï¼Œä¸¾æŠ¥</strong>äº”ç±»å®æ—¶æŒ‡æ ‡ï¼Œå¹¶ä¸”æ±‡æ€»æˆ photo_idã€1 åˆ†é’Ÿæ—¶é—´ç²’åº¦çš„å®æ—¶è§†é¢‘æ¶ˆè´¹å®½è¡¨ï¼ˆå³å®½è¡¨å­—æ®µè‡³å°‘ä¸ºï¼š<strong>photo_id + play_cnt + like_cnt + comment_cnt + share_cnt + negative_cnt + minute_timestamp</strong>ï¼‰äº§å‡ºè‡³å®æ—¶å¤§å±ã€‚</p>
<p>é—®é¢˜åœ¨äºå¯¹åŒä¸€ä¸ªè§†é¢‘ï¼Œäº”ç±»è§†é¢‘æ¶ˆè´¹è¡Œä¸ºçš„è§¦å‘æœºåˆ¶ä»¥åŠä¸ŠæŠ¥æ—¶é—´æ˜¯ä¸åŒï¼Œä¹Ÿå°±å†³å®šäº†å¯¹å®æ—¶å¤„ç†æ¥è¯´äº”ç±»è¡Œä¸ºæ—¥å¿—å¯¹åº”ç€äº”ä¸ªä¸åŒçš„æ•°æ®æºã€‚sql boy ä»¬è‡ªç„¶å°±æƒ³åˆ°äº† join æ“ä½œå°†äº”ç±»æ¶ˆè´¹è¡Œä¸ºæ—¥å¿—åˆå¹¶ï¼Œå¯æ˜¯å®æ—¶ join(cogroup) çœŸçš„é‚£ä¹ˆå®Œç¾å’©~ï¼Œä¸‹æ–‡ç»†è°ˆã€‚</p>
<h3 id="source-è¾“å…¥ä»¥åŠç‰¹ç‚¹"><a href="#source-è¾“å…¥ä»¥åŠç‰¹ç‚¹" class="headerlink" title="source è¾“å…¥ä»¥åŠç‰¹ç‚¹"></a>source è¾“å…¥ä»¥åŠç‰¹ç‚¹</h3><p>é¦–å…ˆæˆ‘ä»¬åˆ†æä¸‹éœ€æ±‚ä¸­çš„ source ç‰¹ç‚¹ï¼š</p>
<ul>
<li>photo_id ç²’åº¦ playï¼ˆæ’­æ”¾ï¼‰ã€likeï¼ˆç‚¹èµï¼‰ã€commentï¼ˆè¯„è®ºï¼‰ã€shareï¼ˆåˆ†äº«ï¼‰ã€negativeï¼ˆä¸¾æŠ¥ï¼‰æ˜ç»†æ•°æ®ï¼Œ<strong>ç”¨æˆ·æ’­æ”¾ï¼ˆç‚¹èµã€è¯„è®ºâ€¦ï¼‰n æ¬¡ï¼Œå®¢æˆ·ç«¯\æœåŠ¡ç«¯å°±ä¼šä¸Šä¼  n æ¡æ’­æ”¾ï¼ˆç‚¹èµã€è¯„è®ºâ€¦ï¼‰æ—¥å¿—è‡³æ•°æ®æº</strong></li>
<li>äº”ç±»è§†é¢‘æ¶ˆè´¹è¡Œä¸ºæ—¥å¿—çš„ source schema éƒ½ä¸ºï¼š<strong>photo_id + timestamp + å…¶ä»–ç»´åº¦</strong></li>
</ul>
<h3 id="sink-è¾“å‡ºä»¥åŠç‰¹ç‚¹"><a href="#sink-è¾“å‡ºä»¥åŠç‰¹ç‚¹" class="headerlink" title="sink è¾“å‡ºä»¥åŠç‰¹ç‚¹"></a>sink è¾“å‡ºä»¥åŠç‰¹ç‚¹</h3><p>sink ç‰¹ç‚¹å¦‚ä¸‹ï¼š</p>
<ul>
<li>photo_id ç²’åº¦ playï¼ˆæ’­æ”¾ï¼‰ã€likeï¼ˆç‚¹èµï¼‰ã€commentï¼ˆè¯„è®ºï¼‰ã€shareï¼ˆåˆ†äº«ï¼‰ã€negativeï¼ˆä¸¾æŠ¥ï¼‰<strong>1 åˆ†é’Ÿçº§åˆ«çª—å£èšåˆæ•°æ®</strong></li>
<li>å®æ—¶è§†é¢‘æ¶ˆè´¹å®½è¡¨ sink schema ä¸ºï¼š<strong>photo_id + play_cnt + like_cnt + comment_cnt + share_cnt + negative_cnt +  minute_timestamp</strong></li>
</ul>
<h3 id="sourceã€sink-æ ·ä¾‹æ•°æ®"><a href="#sourceã€sink-æ ·ä¾‹æ•°æ®" class="headerlink" title="sourceã€sink æ ·ä¾‹æ•°æ®"></a>sourceã€sink æ ·ä¾‹æ•°æ®</h3><p>source æ•°æ®ï¼š<br>| photo_id       | timestamp |         user_id | è¯´æ˜ |<br>| â€”â€”â€” | â€“ | â€”â€”â€”â€“ | â€”â€”â€”â€“ |<br>| 1     |  2020/10/3 11:30:33  |     3 | æ’­æ”¾ |<br>| 1   |  2020/10/3 11:30:33  |   4 | æ’­æ”¾ |<br>| 1   |  2020/10/3 11:30:33  |   5 | æ’­æ”¾ |<br>| 1   |  2020/10/3 11:30:33  |   4 | ç‚¹èµ |<br>| 2 |  2020/10/3 11:30:33  | 5 | ç‚¹èµ |<br>| 1 |  2020/10/3 11:30:33  | 5 | è¯„è®º |</p>
<p>sink æ•°æ®ï¼š<br>| photo_id       | timestamp | play_cnt | like_cnt | comment_cnt<br>| â€”â€”â€” | â€“ | â€”â€”â€”â€“ | â€”â€”â€”â€“ | â€”â€”â€”â€“ |<br>| 1     |  2020/10/3 11:30:00  |     3 | 1 | 1 |<br>| 2   |  2020/10/3 11:30:00  |   0 | 1 | 0 |</p>
<p>æˆ‘ä»¬å·²ç»å¯¹æ•°æ®æºè¾“å…¥å’Œè¾“å‡ºæœ‰äº†å®Œæ•´çš„åˆ†æï¼Œé‚£å°±ç§ç§æœ‰ä»€ä¹ˆæ–¹æ¡ˆå¯ä»¥å®ç°ä¸Šè¿°éœ€æ±‚å§ã€‚</p>
<h2 id="å®ç°æ–¹æ¡ˆ"><a href="#å®ç°æ–¹æ¡ˆ" class="headerlink" title="å®ç°æ–¹æ¡ˆ"></a>å®ç°æ–¹æ¡ˆ</h2><ul>
<li>æ–¹æ¡ˆ1ï¼š<strong>æœ¬å°èŠ‚ cogroup æ–¹æ¡ˆ</strong>ç›´æ¥æ¶ˆè´¹åŸå§‹æ—¥å¿—æ•°æ®ï¼Œå¯¹äº”ç±»ä¸åŒçš„è§†é¢‘æ¶ˆè´¹è¡Œä¸ºæ—¥å¿—ä½¿ç”¨ cogroup æˆ–è€… join è¿›è¡Œçª—å£èšåˆè®¡ç®—</li>
<li>æ–¹æ¡ˆ2ï¼šå¯¹äº”ç±»ä¸åŒçš„è§†é¢‘æ¶ˆè´¹è¡Œä¸ºæ—¥å¿—åˆ†åˆ«å•ç‹¬èšåˆè®¡ç®—å‡ºåˆ†é’Ÿç²’åº¦æŒ‡æ ‡æ•°æ®ï¼Œä¸‹æ¸¸å†å¯¹èšåˆå¥½çš„æŒ‡æ ‡æ•°æ®æŒ‰ç…§ photo_id è¿›è¡Œåˆå¹¶</li>
<li>æ–¹æ¡ˆ3ï¼š<strong>æœ¬å°èŠ‚ union æ–¹æ¡ˆ</strong>æ—¢ç„¶æ•°æ®æº schema ç›¸åŒï¼Œç›´æ¥å¯¹äº”ç±»ä¸åŒçš„è§†é¢‘æ¶ˆè´¹è¡Œä¸ºæ—¥å¿—åš union æ“ä½œï¼Œåœ¨åç»­çš„çª—å£å‡½æ•°ä¸­å¯¹äº”ç±»æŒ‡æ ‡è¿›è¡Œèšåˆè®¡ç®—ã€‚åæ–‡ä»‹ç» union æ–¹æ¡ˆçš„è®¾è®¡è¿‡ç¨‹</li>
</ul>
<p>æˆ‘ä»¬å…ˆä¸Š cogroup æ–¹æ¡ˆçš„ç¤ºä¾‹ä»£ç ã€‚</p>
<h3 id="cogroup"><a href="#cogroup" class="headerlink" title="cogroup"></a>cogroup</h3><p>cogroup å®ç°ç¤ºä¾‹å¦‚ä¸‹ï¼Œç¤ºä¾‹ä»£ç ç›´æ¥ä½¿ç”¨äº†å¤„ç†æ—¶é—´ï¼ˆä¹Ÿå¯æ›¿æ¢ä¸ºäº‹ä»¶æ—¶é—´~ï¼‰ï¼Œå› æ­¤å¯¹æ•°æ®æºçš„æ—¶é—´æˆ³åšäº†ç®€åŒ–ï¼ˆç›´æ¥å¹²æ‰ï¼‰ï¼š</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Cogroup</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> Exception </span>&#123;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">final</span> StreamExecutionEnvironment env = StreamExecutionEnvironment.getExecutionEnvironment();</span><br><span class="line"></span><br><span class="line">        <span class="comment">// Long -&gt; photo_id æ’­æ”¾ä¸€æ¬¡</span></span><br><span class="line">        DataStream&lt;Long&gt; play = SourceFactory.getDataStream(xxx);</span><br><span class="line">        <span class="comment">// Long -&gt; photo_id ç‚¹èµä¸€æ¬¡</span></span><br><span class="line">        DataStream&lt;Long&gt; like = SourceFactory.getDataStream(xxx);</span><br><span class="line">        <span class="comment">// Long -&gt; photo_id è¯„è®ºä¸€æ¬¡</span></span><br><span class="line">        DataStream&lt;Long&gt; comment = SourceFactory.getDataStream(xxx);</span><br><span class="line">        <span class="comment">// Long -&gt; photo_id åˆ†äº«ä¸€æ¬¡</span></span><br><span class="line">        DataStream&lt;Long&gt; share = SourceFactory.getDataStream(xxx);</span><br><span class="line">        <span class="comment">// Long -&gt; photo_id ä¸¾æŠ¥ä¸€æ¬¡</span></span><br><span class="line">        DataStream&lt;Long&gt; negative = SourceFactory.getDataStream(xxx);</span><br><span class="line"></span><br><span class="line">        <span class="comment">// Tuple3&lt;Long, Long, Long&gt; -&gt; photo_id + play_cnt + like_cnt æ’­æ”¾å’Œç‚¹èµçš„æ•°æ®åˆå¹¶</span></span><br><span class="line">        DataStream&lt;Tuple3&lt;Long, Long, Long&gt;&gt; playAndLikeCnt = play</span><br><span class="line">            .coGroup(like)</span><br><span class="line">            .where(KeySelectorFactory.get(Function.identity()))</span><br><span class="line">            .equalTo(KeySelectorFactory.get(Function.identity()))</span><br><span class="line">            .window(TumblingProcessingTimeWindows.of(Time.seconds(<span class="number">60</span>)))</span><br><span class="line">            .apply(xxx1);</span><br><span class="line"></span><br><span class="line">        <span class="comment">// Tuple4&lt;Long, Long, Long, Long&gt; -&gt; photo_id + play_cnt + like_cnt + comment_cnt æ’­æ”¾ã€ç‚¹èµã€è¯„è®ºçš„æ•°æ®åˆå¹¶</span></span><br><span class="line">        DataStream&lt;Tuple4&lt;Long, Long, Long, Long, Long&gt;&gt; playAndLikeAndComment = playAndLikeCnt</span><br><span class="line">            .coGroup(comment)</span><br><span class="line">            .where(KeySelectorFactory.get(playAndLikeModel -&gt; playAndLikeModel.f0))</span><br><span class="line">            .equalTo(KeySelectorFactory.get(Function.identity()))</span><br><span class="line">            .window(TumblingProcessingTimeWindows.of(Time.seconds(<span class="number">60</span>)))</span><br><span class="line">            .apply(xxx2);</span><br><span class="line"></span><br><span class="line">        <span class="comment">// Tuple5&lt;Long, Long, Long, Long, Long&gt; -&gt; photo_id + play_cnt + like_cnt + comment_cnt + share_cnt æ’­æ”¾ã€ç‚¹èµã€è¯„è®ºã€åˆ†äº«çš„æ•°æ®åˆå¹¶</span></span><br><span class="line">        DataStream&lt;Tuple5&lt;Long, Long, Long, Long, Long, Long&gt;&gt; playAndLikeAndCommentAndShare = playAndLikeAndComment</span><br><span class="line">            .coGroup(share)</span><br><span class="line">            .where(KeySelectorFactory.get(playAndLikeAndCommentModel -&gt; playAndLikeAndCommentModel.f0))</span><br><span class="line">            .equalTo(KeySelectorFactory.get(Function.identity()))</span><br><span class="line">            .window(TumblingProcessingTimeWindows.of(Time.seconds(<span class="number">60</span>)))</span><br><span class="line">            .apply(xxx2);</span><br><span class="line"></span><br><span class="line">        <span class="comment">// Tuple7&lt;Long, Long, Long, Long, Long, Long, Long&gt; -&gt; photo_id + play_cnt + like_cnt + comment_cnt + share_cnt + negative_cnt + minute_timestamp æ’­æ”¾ã€ç‚¹èµã€è¯„è®ºã€åˆ†äº«ã€ä¸¾æŠ¥çš„æ•°æ®åˆå¹¶</span></span><br><span class="line">        <span class="comment">// åŒä¸Š~</span></span><br><span class="line">        DataStream&lt;Tuple7&lt;Long, Long, Long, Long, Long, Long, Long&gt;&gt; playAndLikeAndCommentAndShare = ***;</span><br><span class="line"></span><br><span class="line">        env.execute();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>ç²—æš´ä¸€æƒ³ï¼Œä¸Šé¢è¿™æ ·ä¸€æä¸å°±ç»“æŸäº†ä¹ˆï¼Œäº‹æƒ…æ²¡é‚£ä¹ˆç®€å•ï¼Œæˆ‘ä»¬æ¥åšä¸€ä¸ªè¯¦ç»†ç‚¹çš„åˆ†æã€‚</p>
<h3 id="ä¸Šè¿°å®ç°å¯èƒ½ä¼šå­˜åœ¨çš„é—®é¢˜ç‚¹"><a href="#ä¸Šè¿°å®ç°å¯èƒ½ä¼šå­˜åœ¨çš„é—®é¢˜ç‚¹" class="headerlink" title="ä¸Šè¿°å®ç°å¯èƒ½ä¼šå­˜åœ¨çš„é—®é¢˜ç‚¹"></a>ä¸Šè¿°å®ç°å¯èƒ½ä¼šå­˜åœ¨çš„é—®é¢˜ç‚¹</h3><ul>
<li><strong>ä» flink æ¶ˆè´¹åˆ° play æ•°æ®æºçš„ä¸€æ¡æ•°æ®åˆ°æœ€ç»ˆäº§å‡ºè¿™æ¡æ•°æ®è¢«èšåˆåçš„æ•°æ®ï¼Œæ•´ä¸ªè¿‡ç¨‹çš„æ•°æ®å»¶è¿Ÿ &gt; 3 åˆ†é’Ÿâ€¦</strong></li>
<li><strong>å¦‚æœæ•°æ®æºæŒç»­å¢åŠ ï¼ˆæ¯”å¦‚æ·»åŠ å…¶ä»–è§†é¢‘æ¶ˆè´¹æ“ä½œæ•°æ®æºï¼‰ï¼Œåˆ™æ•´ä¸ªä»»åŠ¡ç®—å­å˜å¤šï¼Œæ•°æ®é“¾è·¯æ›´é•¿ï¼Œä»»åŠ¡ç¨³å®šæ€§ä¼šå˜å·®ï¼Œäº§å‡ºæ•°æ®å»¶è¿Ÿä¹Ÿä¼šéšç€çª—å£è®¡ç®—å˜å¤šï¼Œå»¶è¿Ÿæ›´ä¹…</strong></li>
</ul>
<blockquote>
<p><strong>æ•°æ®äº§å“å¦¹å¦¹</strong>ï¼šğŸ¤©ï¼Œå°å“¥å“¥å¥½æ£’ï¼Œæ—¢ç„¶é—®é¢˜ç‚¹éƒ½åˆ†æå‡ºæ¥äº†ï¼ŒæŠ€æœ¯å°å“¥å“¥å°±å¸®äººå®¶è§£å†³ä¸€ä¸‹å˜›~</p>
<p><strong>å¤´æ–‡å­— âˆ© æŠ€æœ¯å°å“¥å“¥</strong>ï¼šæã€‚</p>
<p><strong>å¤´æ–‡å­— âˆ© æŠ€æœ¯å°å“¥å“¥</strong>ï¼šæ—¢ç„¶å¯èƒ½ç”±äºè¿‡å¤šçš„çª—å£å¯¼è‡´æ•°æ®äº§å‡ºå»¶è¿Ÿï¼Œjob ä¸ç¨³å®šï¼Œé‚£æœ‰æ²¡æœ‰ä»€ä¹ˆæ–¹æ³•å‡å°‘çª—å£æ•°é‡å‘¢ï¼Œæ€è·¯è½¬æ¢ä¸€ä¸‹ã€‚æˆ‘ä»¬ç›´æ¥ä»¥æ•´ä¸ª job ä¸­åªåŒ…å«ä¸€ä¸ªçª—å£ç®—å­æ“ä½œä¸ºåŸºç‚¹ï¼Œé€†æ¨ä¸€ä¸‹ï¼Œåˆ™æœ‰ä»¥ä¸‹æ•°æ®é“¾è·¯ã€‚</p>
</blockquote>
<h3 id="é€†æ¨é“¾è·¯"><a href="#é€†æ¨é“¾è·¯" class="headerlink" title="é€†æ¨é“¾è·¯"></a>é€†æ¨é“¾è·¯</h3><p>1 - 5 ä¸ºé€†æ¨çš„æ•´æ¡é“¾è·¯ã€‚</p>
<ul>
<li><strong>1.äº”ç±»æŒ‡æ ‡çš„æ•°æ®éƒ½åœ¨å•ä¸ªçª—å£ä¸­è®¡ç®—</strong></li>
<li><strong>2.äº”ç±»æŒ‡æ ‡çš„çª—å£ model ç›¸åŒ</strong></li>
<li><strong>3.keyby ä¸­çš„ key ä¸€è‡´ï¼ˆphoto_idï¼‰</strong></li>
<li><strong>4.äº”ç±»æŒ‡æ ‡çš„æ•°æ®æºéƒ½ä¸º photo_id ç²’åº¦ï¼Œå¹¶ä¸”äº”ç±»æ•°æ®æºçš„ model éƒ½å¿…é¡»ç›¸åŒï¼Œå¹¶ä¸”å¯ä»¥åšåˆå¹¶</strong></li>
<li><strong>5.union ç®—å­å¯ä»¥å¯¹äº”ç±»æ•°æ®æºåšåˆå¹¶ï¼ï¼ï¼</strong></li>
</ul>
<p>è¯ä¸å¤šè¯´ç›´æ¥ä¸Š union æ–¹æ¡ˆä»£ç ã€‚</p>
<h2 id="union"><a href="#union" class="headerlink" title="union"></a>union</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Union</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> Exception </span>&#123;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">final</span> StreamExecutionEnvironment env = StreamExecutionEnvironment.getExecutionEnvironment();</span><br><span class="line"></span><br><span class="line">        <span class="comment">// Tuple2&lt;Long, String&gt; -&gt; photo_id + "PLAY"æ ‡ç­¾</span></span><br><span class="line">        DataStream&lt;Tuple2&lt;Long, String&gt;&gt; play = SourceFactory.getDataStream(xxx);</span><br><span class="line">        <span class="comment">// Tuple2&lt;Long, String&gt; -&gt; photo_id + "LIKE"æ ‡ç­¾</span></span><br><span class="line">        DataStream&lt;Tuple2&lt;Long, String&gt;&gt; like = SourceFactory.getDataStream(xxx);</span><br><span class="line">        <span class="comment">// Tuple2&lt;Long, String&gt; -&gt; photo_id + "COMMENT"æ ‡ç­¾</span></span><br><span class="line">        DataStream&lt;Tuple2&lt;Long, String&gt;&gt; comment = SourceFactory.getDataStream(xxx);</span><br><span class="line">        <span class="comment">// Tuple2&lt;Long, String&gt; -&gt; photo_id + "SHARE"æ ‡ç­¾</span></span><br><span class="line">        DataStream&lt;Tuple2&lt;Long, String&gt;&gt; share = SourceFactory.getDataStream(xxx);</span><br><span class="line">        <span class="comment">// Tuple2&lt;Long, String&gt; -&gt; photo_id + "NEGATIVE"æ ‡ç­¾</span></span><br><span class="line">        DataStream&lt;Tuple2&lt;Long, String&gt;&gt; negative = SourceFactory.getDataStream(xxx);</span><br><span class="line"></span><br><span class="line">        <span class="comment">// Tuple5&lt;Long, Long, Long, Long&gt; -&gt; photo_id + play_cnt + like_cnt + comment_cnt + window_start_timestamp</span></span><br><span class="line">        DataStream&lt;Tuple3&lt;Long, Long, Long&gt;&gt; playAndLikeCnt = play</span><br><span class="line">            .union(like)</span><br><span class="line">            .union(comment)</span><br><span class="line">            .union(share)</span><br><span class="line">            .union(negative)</span><br><span class="line">            .keyBy(KeySelectorFactory.get(i -&gt; i.f0))</span><br><span class="line">            .timeWindow(Time.seconds(<span class="number">60</span>))</span><br><span class="line">            .process(xxx);</span><br><span class="line"></span><br><span class="line">        env.execute();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>å¯ä»¥å‘ç°ï¼Œæ— è®ºä¸Šæ¸¸æ•°æ®æºæ€æ ·è¿›è¡Œå˜åŒ–ï¼Œä¸Šè¿° union æ–¹æ¡ˆä¸­å§‹ç»ˆå¯ä»¥ä¿æŒåªæœ‰ä¸€ä¸ªçª—å£ç®—å­å¤„ç†å’Œè®¡ç®—æ•°æ®ï¼Œåˆ™å¯ä»¥è§£å†³ä¹‹å‰åˆ—ä¸¾çš„æ•°æ®å»¶è¿Ÿä»¥åŠ flink ä»»åŠ¡ç®—å­è¿‡å¤šçš„é—®é¢˜ã€‚</p>
<p>åœ¨æ•°æ®æºçš„ schema ç›¸åŒï¼ˆæˆ–è€…ä¸åŒä½†ç»è¿‡å¤„ç†ä¹‹åå¯ä»¥ format æˆç›¸åŒæ ¼å¼ï¼‰çš„æƒ…å†µä¸‹ï¼Œæˆ–è€…å¤„ç†é€»è¾‘ç›¸åŒçš„è¯ï¼Œå¯ä»¥ä½¿ç”¨ union è¿›è¡Œé€»è¾‘ç®€åŒ–ã€‚</p>
<h2 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h2><p>æœ¬æ–‡é¦–å…ˆä»‹ç»äº†æˆ‘ä»¬çš„éœ€æ±‚åœºæ™¯ï¼Œç¬¬äºŒéƒ¨åˆ†åˆ†æäº†ä½¿ç”¨ cogroupï¼ˆæ¡ˆä¾‹ä»£ç ï¼‰æ˜¯å¦‚ä½•è§£å†³æ­¤éœ€æ±‚åœºæ™¯ï¼Œå†åˆ†æäº†æ­¤å®ç°æ–¹æ¡ˆå¯èƒ½ä¼šå­˜åœ¨ä¸€äº›é—®é¢˜ï¼Œå¹¶å¼•å‡ºäº† union è§£å†³æ–¹æ¡ˆçš„é€†æ¨å’Œè®¾è®¡æ€è·¯ã€‚<br>åœ¨ç¬¬ä¸‰éƒ¨åˆ†é’ˆå¯¹æ­¤åœºæ™¯ä½¿ç”¨ union ä»£æ›¿ cogroup è¿›è¡Œäº†ä¸€å®šç¨‹åº¦ä¸Šçš„ä¼˜åŒ–ã€‚å¦‚æœé’ˆå¯¹æ­¤åœºæ™¯ï¼Œå¤§ä½¬ä»¬æœ‰æ›´å¥½çš„ä¼˜åŒ–æ–¹æ¡ˆçš„è¯ï¼ŒæœŸå¾…ç•™è¨€å–”ã€‚</p>
<figure class="image-bubble">
                <div class="img-lightbox">
                    <div class="overlay"></div>
                    <img src="/blog-img/gzh/wechat.png" alt="å…¬ä¼—å·" title>
                </div>
                <div class="image-caption">å…¬ä¼—å·</div>
            </figure>
        </div>

        <blockquote class="post-copyright">
    
    <div class="content">
        
<span class="post-time">
    æœ€åæ›´æ–°æ—¶é—´ï¼š<time datetime="2020-10-04T13:21:52.892Z" itemprop="dateUpdated">2020-10-04 21:21:52</time>
</span><br>


        
        æœ¬æ–‡é“¾æ¥ï¼š<a href="/2020/10/03/wechat-blog/apache-flink:realtime-tips-2-union-join/" target="_blank" rel="external">https://yangyichao-mango.github.io/2020/10/03/wechat-blog/apache-flink:realtime-tips-2-union-join/</a>
  <br>è½¬è½½é¡»çŸ¥ï¼š<a href="/about/#ç‰ˆæƒå£°æ˜" target="_blank" rel="copyright">ç‰ˆæƒå£°æ˜</a>

        
    </div>
    
    <footer>
        <a href="https://yangyichao-mango.github.io">
            <img src="/img/avatar.jpg" alt="yangyichao-mango">
            yangyichao-mango
        </a>
    </footer>
</blockquote>

        
<div class="page-reward">
    <a id="rewardBtn" href="javascript:;" class="page-reward-btn waves-effect waves-circle waves-light">èµ</a>
</div>



        <div class="post-footer">
            
	<ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Apache-Flink/">Apache Flink</a></li></ul>


            
<div class="page-share-wrap">
    

<div class="page-share" id="pageShare">
    <ul class="reset share-icons">
      <li>
        <a class="weibo share-sns" target="_blank" href="http://service.weibo.com/share/share.php?url=https://yangyichao-mango.github.io/2020/10/03/wechat-blog/apache-flink:realtime-tips-2-union-join/&title=ã€ŠTips | Flink ä½¿ç”¨ union ä»£æ›¿ joinã€cogroupã€‹ â€” yangyichao-mango's blog&pic=https://yangyichao-mango.github.io/img/avatar.jpg" data-title="å¾®åš">
          <i class="icon icon-weibo"></i>
        </a>
      </li>
      <li>
        <a class="weixin share-sns wxFab" href="javascript:;" data-title="å¾®ä¿¡">
          <i class="icon icon-weixin"></i>
        </a>
      </li>
      <li>
        <a class="qq share-sns" target="_blank" href="http://connect.qq.com/widget/shareqq/index.html?url=https://yangyichao-mango.github.io/2020/10/03/wechat-blog/apache-flink:realtime-tips-2-union-join/&title=ã€ŠTips | Flink ä½¿ç”¨ union ä»£æ›¿ joinã€cogroupã€‹ â€” yangyichao-mango's blog&source=" data-title=" QQ">
          <i class="icon icon-qq"></i>
        </a>
      </li>
      <li>
        <a class="facebook share-sns" target="_blank" href="https://www.facebook.com/sharer/sharer.php?u=https://yangyichao-mango.github.io/2020/10/03/wechat-blog/apache-flink:realtime-tips-2-union-join/" data-title=" Facebook">
          <i class="icon icon-facebook"></i>
        </a>
      </li>
      <li>
        <a class="twitter share-sns" target="_blank" href="https://twitter.com/intent/tweet?text=ã€ŠTips | Flink ä½¿ç”¨ union ä»£æ›¿ joinã€cogroupã€‹ â€” yangyichao-mango's blog&url=https://yangyichao-mango.github.io/2020/10/03/wechat-blog/apache-flink:realtime-tips-2-union-join/&via=https://yangyichao-mango.github.io" data-title=" Twitter">
          <i class="icon icon-twitter"></i>
        </a>
      </li>
      <li>
        <a class="google share-sns" target="_blank" href="https://plus.google.com/share?url=https://yangyichao-mango.github.io/2020/10/03/wechat-blog/apache-flink:realtime-tips-2-union-join/" data-title=" Google+">
          <i class="icon icon-google-plus"></i>
        </a>
      </li>
    </ul>
 </div>



    <a href="javascript:;" id="shareFab" class="page-share-fab waves-effect waves-circle">
        <i class="icon icon-share-alt icon-lg"></i>
    </a>
</div>



        </div>
    </div>

    
<nav class="post-nav flex-row flex-justify-between flex-row-reverse">
  

  
    <div class="waves-block waves-effect next">
      <a href="/2020/09/12/wechat-blog/apache-flink:realtime-tips-1/" id="post-next" class="post-nav-link">
        <div class="tips">Next <i class="icon icon-angle-right icon-lg icon-pl"></i></div>
        <h4 class="title">Tips | Flink sink schema å­—æ®µè®¾è®¡å°æŠ€å·§</h4>
      </a>
    </div>
  
</nav>



    


<section class="comments" id="comments">
    <div id="disqus_thread"></div>
    <script>
    var disqus_shortname = 'true';
    lazyScripts.push('//' + disqus_shortname + '.disqus.com/embed.js')
    </script>
    <noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
</section>



















</article>

<div id="reward" class="page-modal reward-lay">
    <a class="close" href="javascript:;"><i class="icon icon-close"></i></a>
    <h3 class="reward-title">
        <i class="icon icon-quote-left"></i>
        è°¢è°¢å¤§çˆ·~
        <i class="icon icon-quote-right"></i>
    </h3>
    <div class="reward-content">
        
        <div class="reward-code">
            <img id="rewardCode" src="/img/wechat.png" alt="æ‰“èµäºŒç»´ç ">
        </div>
        
        <label class="reward-toggle">
            <input id="rewardToggle" type="checkbox" class="reward-toggle-check"
                data-wechat="/img/wechat.png" data-alipay="/img/alipay.png">
            <div class="reward-toggle-ctrol">
                <span class="reward-toggle-item wechat">å¾®ä¿¡</span>
                <span class="reward-toggle-label"></span>
                <span class="reward-toggle-item alipay">æ”¯ä»˜å®</span>
            </div>
        </label>
        
    </div>
</div>



</div>

        <footer class="footer">
    <div class="top">
        
<p>
    <span id="busuanzi_container_site_uv" style='display:none'>
        ç«™ç‚¹æ€»è®¿å®¢æ•°ï¼š<span id="busuanzi_value_site_uv"></span>
    </span>
    <span id="busuanzi_container_site_pv" style='display:none'>
        ç«™ç‚¹æ€»è®¿é—®é‡ï¼š<span id="busuanzi_value_site_pv"></span>
    </span>
</p>


        <p>
            
                <span><a href="/atom.xml" target="_blank" class="rss" title="rss"><i class="icon icon-lg icon-rss"></i></a></span>
            
            <span>åšå®¢å†…å®¹éµå¾ª <a rel="license" href="https://creativecommons.org/licenses/by-nc-sa/4.0/deed.zh">çŸ¥è¯†å…±äº« ç½²å - éå•†ä¸šæ€§ - ç›¸åŒæ–¹å¼å…±äº« 4.0 å›½é™…åè®®</a></span>
        </p>
    </div>
    <div class="bottom">
        <p><span>yangyichao-mango &copy; 2019 - 2020</span>
            <span>
                
                Power by <a href="http://hexo.io/" target="_blank">Hexo</a> Theme <a href="https://github.com/yscoder/hexo-theme-indigo" target="_blank">indigo</a>
            </span>
        </p>
    </div>
</footer>

    </main>
    <div class="mask" id="mask"></div>
<a href="javascript:;" id="gotop" class="waves-effect waves-circle waves-light"><span class="icon icon-lg icon-chevron-up"></span></a>



<div class="global-share" id="globalShare">
    <ul class="reset share-icons">
      <li>
        <a class="weibo share-sns" target="_blank" href="http://service.weibo.com/share/share.php?url=https://yangyichao-mango.github.io/2020/10/03/wechat-blog/apache-flink:realtime-tips-2-union-join/&title=ã€ŠTips | Flink ä½¿ç”¨ union ä»£æ›¿ joinã€cogroupã€‹ â€” yangyichao-mango's blog&pic=https://yangyichao-mango.github.io/img/avatar.jpg" data-title="å¾®åš">
          <i class="icon icon-weibo"></i>
        </a>
      </li>
      <li>
        <a class="weixin share-sns wxFab" href="javascript:;" data-title="å¾®ä¿¡">
          <i class="icon icon-weixin"></i>
        </a>
      </li>
      <li>
        <a class="qq share-sns" target="_blank" href="http://connect.qq.com/widget/shareqq/index.html?url=https://yangyichao-mango.github.io/2020/10/03/wechat-blog/apache-flink:realtime-tips-2-union-join/&title=ã€ŠTips | Flink ä½¿ç”¨ union ä»£æ›¿ joinã€cogroupã€‹ â€” yangyichao-mango's blog&source=" data-title=" QQ">
          <i class="icon icon-qq"></i>
        </a>
      </li>
      <li>
        <a class="facebook share-sns" target="_blank" href="https://www.facebook.com/sharer/sharer.php?u=https://yangyichao-mango.github.io/2020/10/03/wechat-blog/apache-flink:realtime-tips-2-union-join/" data-title=" Facebook">
          <i class="icon icon-facebook"></i>
        </a>
      </li>
      <li>
        <a class="twitter share-sns" target="_blank" href="https://twitter.com/intent/tweet?text=ã€ŠTips | Flink ä½¿ç”¨ union ä»£æ›¿ joinã€cogroupã€‹ â€” yangyichao-mango's blog&url=https://yangyichao-mango.github.io/2020/10/03/wechat-blog/apache-flink:realtime-tips-2-union-join/&via=https://yangyichao-mango.github.io" data-title=" Twitter">
          <i class="icon icon-twitter"></i>
        </a>
      </li>
      <li>
        <a class="google share-sns" target="_blank" href="https://plus.google.com/share?url=https://yangyichao-mango.github.io/2020/10/03/wechat-blog/apache-flink:realtime-tips-2-union-join/" data-title=" Google+">
          <i class="icon icon-google-plus"></i>
        </a>
      </li>
    </ul>
 </div>


<div class="page-modal wx-share" id="wxShare">
    <a class="close" href="javascript:;"><i class="icon icon-close"></i></a>
    <p>æ‰«ä¸€æ‰«ï¼Œåˆ†äº«åˆ°å¾®ä¿¡</p>
    <img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAPYAAAD2CAAAAADAeSUUAAADLklEQVR42u3aSXIiQRAEQP7/aeYBEk1EVmuMKrxPGGJpLw6hXB6P+Hq+uF695tUzyeuT9/78nMdfXNjY2NibsJ+XV3KLLeb6cfLK5K/XPxI2Njb2eezrYEjA1+/Nb+j6+fyI3xixsbGxseNoyQHJ7eYBiY2NjY09o+bRkrecZmUPNjY29rexk6ZSXngkBcls/NB+yw29NGxsbOyPZ+dT0c9//CfzbWxsbOwPZj/Lq20MzeJkpeyJFNjY2NgHsdvBbd7Wbz9tpW00vH9sbGzsI9izRcakuZ+PH5JAmh3xy9djY2NjH8fOGSsN+pV35XcSlUDY2NjYB7HbLnobM+1X5gtAbQwXEYiNjY29FXvWrEnKktlSTn7o7RG/yW1sbGzsbdlJFLWFRMJuG0/5M8XwABsbG/sI9mxBJzmmvLWUx9tKI6nYVMLGxsbeip2UFm3DaH0knBcet+U2NjY29rbsuwJm9jgvM1Z+kl8+HxsbG/s4dt5paUuUPLRmW5H51PqXIgQbGxv7CPbKWky7lJOXLnftIkU/AzY2Nvbm7Nm/+PlCT9HZKiNtVsxgY2Njn8deacG3Q+L2WNuCZ1YIYWNjY5/EXoG1EdVGYBtXxZ1gY2NjH8Fej42kuZ+v4+SfNitgsLGxsU9l5w2m/x88bakzHPFiY2Njb8tuh6mzZ9ploPWSKao+sLGxsTdnrzT3Z4XBjJEEW/4abGxs7G9gzxZrkpKmfWVbrkQubGxs7OPY60uW+Zhh/RAf5YWNjY39newEOTuslUCqea+OHhsbG/sgdj5YTVpOeWOoDci2TCpGvNjY2NjHsfObaHdg8oPLj6CNtDq9sbGxsTdk54CVZZo2tNqjj34wbGxs7OPYK+VBu0CT/DWPt2FZgo2NjX0E+1le10GVY/I4nIVlnWnY2NjY27LbAMgjp20wteXKSp8fGxsb+zx2G1qzEMpbVO13DccP2NjY2Mex852WfHFnVpzc1WZ6c8TY2NjY2PEwuC0tZrFUt5mwsbGxv57dNobyQuIGUtKowsbGxj6Ond90Xlq0JcRs2DwcHmBjY2MfxM4HvbMvWF+vuTfMsLGxsQ9i/wN8+SsmrS0UbAAAAABJRU5ErkJggg==" alt="å¾®ä¿¡åˆ†äº«äºŒç»´ç ">
</div>




    <script src="//cdn.bootcss.com/node-waves/0.7.4/waves.min.js"></script>
<script>
var BLOG = { ROOT: '/', SHARE: true, REWARD: true };


</script>

<script src="/js/main.min.js?v=1.7.2"></script>


<div class="search-panel" id="search-panel">
    <ul class="search-result" id="search-result"></ul>
</div>
<template id="search-tpl">
<li class="item">
    <a href="{path}" class="waves-block waves-effect">
        <div class="title ellipsis" title="{title}">{title}</div>
        <div class="flex-row flex-middle">
            <div class="tags ellipsis">
                {tags}
            </div>
            <time class="flex-col time">{date}</time>
        </div>
    </a>
</li>
</template>

<script src="/js/search.min.js?v=1.7.2" async></script>






<script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>





</body>
</html>
